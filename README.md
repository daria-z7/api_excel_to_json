##  Проект "api_excel_to_json"

### Описание проекта:

Серверное приложение для отправки эксель файла и его перевода в формат json.
Приложение имеет один эндпойнт `/upload/excel`, который принимает файлы с расширениями xls, xlsx, xlsm.
В случае успешного получения файла, возвращается ответ "Файл принят в обработку", и файл сохраняется в папку app/Temp.
Отдельный скрипт обрабатывает очередь эксель файлов и конвертирует их в json файлы с одноименными названиями.
В случае успешной обработки json файл сохраняется в папке upload, а эксель файл перемещается в папку app/Archive.
В случае возникновения ошибки при попытке конвертации файла эксель файл перемещается в папку app/Archive_Fail.
Выполнено логирование основных событий - файл app/main.log и app/manage_queue.log.

### Технологии:

При реализации проекта были использованы следующие основные технологии, фреймворки и библиотеки:
- Python 3.7
- Flask 2.1.2

### Ограничения:

Приложение работает пока только с файлами, названными на латинице.

### Как запустить проект:
Клонируйте репозиторий и перейдите в него в командной строке:

```
git clone 'ссылка на репозиторий'
```

```
cd api_excel_to_json
```

Cоздайте и активируйте виртуальное окружение:

```
python -m venv venv
```

```
source venv/Scripts/activate
```
```
python -m pip install --upgrade pip
```

Установите зависимости из файла requirements.txt:

```
pip install -r requirements.txt
```

Перейдите в директорию с исполняемыми файлами:

```
cd app
```

Запустите скрипт, обрабатывающий api запросы:

```
python main.py
```

В соседнем терминале запустите скрипт, обрабатывающий очередь полученных excel файлов:

```
python manage_file_queue.py
```

### Как протестировать проект в Postman:
- Запустите оба скрипта.
- В Postman в качестве типа HTTP метода поставьте 'POST'
- В поле URL пропишите полный путь к эндпойнту 'http://127.0.0.1:5000/upload/excel'
- Выбрать параметр Body, в KEY прописать 'file' и выбрать типом File

![image](https://user-images.githubusercontent.com/94990833/177756135-22d425be-7e0e-4a0e-98ec-c1de637dea62.png)

- В VALUE выбрать файл эксель для отправки

![image](https://user-images.githubusercontent.com/94990833/177756629-89272b36-8822-459b-a4a4-7ecb3acd4fd7.png)

- Нажать Send
- В случае отправки корректного файла должен вернуться ответ:
```
"message": "Файл принят в обработку"
```
- Файл json можно будет найти в папке app/upload
- Если файл уже был ранее отправлен:
```
"message": "Файл с таким именем уже существует"
```
- Если отправить файл с неверным расширением:
```
"message": "Файлы допустимы только в формате xls, xlsx, xlsm"
```
- Если отправить запрос без файла:
```
"message": "Файл отсутсвует в запросе"
```
- Если в структуре запроса отсутствует файл:
```
"message": "Запрос выполнен без файла"
```

### Автор проекта:
- Зайцева Дарья
